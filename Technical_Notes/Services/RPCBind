==============================
RPC (Remote Procedure Call)
Cheat Sheet – Professional
==============================

PORTS:
135/TCP        – RPC Endpoint Mapper
49152–65535/TCP – Dynamic RPC ports (Windows)
593/TCP        – RPC over HTTP (legacy)

RFC / SPECS:
DCE/RPC (Distributed Computing Environment)
MS-RPC (Microsoft RPC)

Transport:
TCP (primary)
Named Pipes (SMB)
HTTP (legacy)

Purpose:
Remote service control
User & domain enumeration
Process, service, printer, registry access
Core Windows / AD communications

--------------------------------
1. BASIC ENUMERATION
--------------------------------

nmap -p135 <IP>
nmap -p135 --script rpcinfo <IP>
nmap -p135,445 <IP>

rpcinfo <IP>
nmap -p135 --script msrpc-enum <IP>

# Anonymous RPC connection
rpcclient -U "" <IP>
rpcclient -U "%" <IP>

# Common enum commands
srvinfo
enumdomains
enumdomusers
enumdomgroups
querydominfo
getdompwinfo

# Domain users
rpcclient -U "" <IP>
> enumdomusers

# RID cycling (manual)
> lookupnames administrator
> lookupsids S-1-5-21-XXXX-500

enumdomgroups
querygroup <RID>
querygroupmem <RID>
getdompwinfo
querydominfo
enumservices
queryservice <service_name>
netshareenum
netshareenumall
netsessenum

Common pipes:
\\PIPE\\samr      – User & group management
\\PIPE\\lsarpc    – LSA policy
\\PIPE\\svcctl    – Service control
\\PIPE\\spoolss   – Printer services
\\PIPE\\netlogon  – Domain auth
\\PIPE\\wkssvc    – Workstation info

crackmapexec smb <IP> --rid-brute

# Manual RID mapping
500  – Administrator
501  – Guest
512  – Domain Admins
513  – Domain Users
514  – Domain Guests

rpcclient -U user <IP>
rpcclient -U user%aad3b435b51404eeaad3b435b51404ee:<NTLM> <IP>

nmap -p135,445 --script smb-enum-users <IP>
nmap -p445 --script smb-vuln-printnightmare <IP>

Windows:
 Event Viewer
 Security Logs
 RPC Runtime Logs
 System Logs

rpcclient
rpcinfo
nmap
crackmapexec
impacket
metasploit
