# Active Directory Pentesting Scenarios (Server-Centric)

> **Purpose**
> This document defines **50 professional Active Directory pentesting scenarios**, ordered from fundamental to advanced Red Team techniques.
> All scenarios are **designed to be executable in a server-centric lab** (Domain Controller + attacker machine) and aligned with **OSCP / OSEP / real-world AD assessments**.

---

## ðŸŸ¢ LEVEL 1 â€” FOUNDATION & ENUMERATION (1â€“10)

**Objective:** Understand domain structure, identity boundaries, and attack surface.

### 1. Anonymous SMB Enumeration

* **Prerequisite:** SMB service reachable
* **Goal:** Identify exposed shares and policies
* **Success Criteria:** SYSVOL / NETLOGON visibility
* **Defense Insight:** Disable anonymous SMB access

### 2. LDAP Base Enumeration

* **Prerequisite:** LDAP reachable (389/636)
* **Goal:** Extract domain naming contexts
* **Success Criteria:** Domain DN, DC hostname discovered
* **Defense Insight:** LDAP signing & channel binding

### 3. Domain User Enumeration

* **Prerequisite:** Valid or null session
* **Goal:** Enumerate domain users
* **Success Criteria:** User list extracted
* **Defense Insight:** Limit anonymous RPC queries

### 4. Domain Group Enumeration

* **Goal:** Identify privileged groups
* **Success Criteria:** Domain Admins, Enterprise Admins mapped

### 5. Password Policy Discovery

* **Goal:** Extract password complexity & lockout rules
* **Success Criteria:** Full password policy obtained

### 6. Domain Functional Level Identification

* **Goal:** Determine AD security capabilities
* **Success Criteria:** Functional level confirmed

### 7. AD Service Surface Mapping

* **Goal:** Enumerate Kerberos, SMB, RPC, LDAP
* **Success Criteria:** Open AD-related services listed

### 8. SYSVOL & NETLOGON Analysis

* **Goal:** Identify scripts and policies
* **Success Criteria:** GPO files reviewed

### 9. Trust Relationship Enumeration

* **Goal:** Identify domain/forest trusts
* **Success Criteria:** Trusts mapped (even single-domain)

### 10. BloodHound Data Collection

* **Goal:** Build AD attack graph
* **Success Criteria:** Complete graph ingestion

---

## ðŸŸ¡ LEVEL 2 â€” CREDENTIAL ACCESS (11â€“20)

**Objective:** Obtain credential material without system compromise.

### 11. AS-REP Roasting

* **Prerequisite:** Users without Kerberos pre-auth
* **Goal:** Extract AS-REP hashes
* **Success Criteria:** Crackable hashes obtained

### 12. Kerberoasting

* **Goal:** Dump service account tickets
* **Success Criteria:** TGS hashes extracted

### 13. Weak Service Account Password Cracking

* **Goal:** Identify weak SPN passwords

### 14. Password Spraying

* **Goal:** Identify reused passwords
* **Success Criteria:** Valid domain credentials

### 15. Passwords in User Description Fields

* **Goal:** Extract plaintext secrets

### 16. Group Policy Preferences (cpassword)

* **Goal:** Decrypt stored credentials

### 17. NTLM Hash Capture (Conceptual)

* **Goal:** Understand NTLM authentication exposure

### 18. SMB Signing Misconfiguration

* **Goal:** Identify relay possibilities

### 19. LAPS Enumeration

* **Goal:** Identify local admin password exposure

### 20. Plaintext Secrets in Scripts

* **Goal:** Extract hardcoded credentials

---

## ðŸŸ  LEVEL 3 â€” PRIVILEGE ESCALATION (21â€“30)

**Objective:** Abuse AD permissions to escalate privileges.

### 21. ACL Abuse â€” GenericAll

* **Goal:** Full control over target object

### 22. ACL Abuse â€” WriteDACL

* **Goal:** Modify object permissions

### 23. Group Membership Abuse

* **Goal:** Escalate via delegated group rights

### 24. GPO Abuse

* **Goal:** Execute code in privileged context

### 25. AdminSDHolder Analysis

* **Goal:** Identify protected objects & abuse paths

### 26. Unconstrained Delegation Discovery

* **Goal:** Identify delegation risks

### 27. Constrained Delegation Abuse

* **Goal:** Impersonate privileged users

### 28. Resource-Based Constrained Delegation (RBCD)

* **Goal:** Service impersonation via machine account

### 29. Password Reset Delegation Abuse

* **Goal:** Reset privileged account passwords

### 30. SPN Hijacking

* **Goal:** Credential interception via SPN reassignment

---

## ðŸ”´ LEVEL 4 â€” DOMAIN DOMINATION (31â€“40)

**Objective:** Achieve and maintain Domain Admin control.

### 31. NTDS.dit Offline Dump

* **Goal:** Extract domain credential database

### 32. NTDS Credential Extraction

* **Goal:** Recover NTLM hashes

### 33. DCSync Attack

* **Goal:** Replicate domain secrets

### 34. Pass-the-Hash

* **Goal:** Authenticate without plaintext password

### 35. Pass-the-Ticket

* **Goal:** Reuse Kerberos tickets

### 36. Golden Ticket Forgery

* **Goal:** Unlimited domain access

### 37. Silver Ticket Forgery

* **Goal:** Service-level persistence

### 38. SID History Injection

* **Goal:** Privilege inheritance abuse

### 39. Skeleton Key (Conceptual)

* **Goal:** Universal password persistence

### 40. DCShadow (Conceptual)

* **Goal:** Stealthy AD object modification

---

## âš« LEVEL 5 â€” OSEP / RED TEAM OPERATIONS (41â€“50)

**Objective:** Persistence, stealth, and long-term control.

### 41. Golden Ticket Persistence Strategy

### 42. ACL Backdoor Persistence

### 43. GPO-Based Persistence

### 44. Service Account Persistence

### 45. Trust Abuse (Intra-Domain)

### 46. Forest-Level Attack Logic

### 47. AV / AMSI Evasion Concepts

### 48. Log Evasion & Artifact Cleanup

### 49. Attack Path Optimization

### 50. Full AD Attack Chain Simulation

* **Initial Access â†’ Credential Access â†’ Privilege Escalation â†’ DA â†’ Persistence**

---

## ðŸ“Œ Usage Guidance

* Execute **sequentially**
* Document **why it works**, not just *how*
* For each scenario define:

  * Entry point
  * Exploited misconfiguration
  * Detection opportunity
  * Mitigation strategy

> **This document is intentionally tool-agnostic**. Tools may change â€” AD mechanics do not.

---

**Author Mindset:** Red Team / OSEP-aligned
**Lab Type:** Server-centric AD environment


